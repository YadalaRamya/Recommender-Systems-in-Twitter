import numpy
from numpy import matrix
a=matrix([[2,8,3,5],[5,12,3,7],[4,11,6,8],[7,11,6,6],[2,1,3,1],[4,11,5,8],[4,2,5,4],[1,1,3,2],[2,2,4,4],[11,15,13,9]])
m1=numpy.mean(a,0)
n1=10
c1=numpy.cov([[2,5,4,7,2,4,4,1,2,11],[8,12,11,11,1,11,2,1,2,15],[3,3,6,6,3,5,5,3,4,13],[5,7,8,6,1,8,4,2,4,9]])
b=matrix([[3,9,5,7],[6,13,4,7],[4,9,6,7],[6,9,8,6],[5,9,5,7],[6,9,5,4],[3,4,4,3],[7,10,5,5],[6,11,6,8],[2,2,3,3],[1,3,2,2],[4,5,5,4],[3,2,3,3],[6,11,7,8],[3,6,4,4]])
m2=numpy.mean(b,0)
n2=15
c2=numpy.cov([[3,6,4,6,5,6,3,7,6,2,1,4,3,6,3],[9,13,9,9,9,9,4,10,11,2,3,5,2,11,6],[5,4,6,8,5,5,4,5,6,3,2,5,3,7,4],[7,7,7,6,7,4,3,5,8,3,2,4,3,8,4]])
c=matrix([[2,8,3,5],[5,12,3,7],[4,11,6,8],[7,11,6,6],[2,1,3,1],[4,11,5,8],[4,2,5,4],[1,1,3,2],[2,2,4,4],[11,15,13,9],[3,9,5,7],[6,13,4,7],[4,9,6,7],[6,9,8,6],[5,9,5,7],[6,9,5,4],[3,4,4,3],[7,10,5,5],[6,11,6,8],[2,2,3,3],[1,3,2,2],[4,5,5,4],[3,2,3,3],[6,11,7,8],[3,6,4,4]])
m3=numpy.mean(c,0)
print m3
c3=numpy.cov([[2,5,4,7,2,4,4,1,2,11,3,6,4,6,5,6,3,7,6,2,1,4,3,6,3],[8,12,11,11,1,11,2,1,2,15,9,13,9,9,9,9,4,10,11,2,3,5,2,11,6],[3,3,6,6,3,5,5,3,4,13,5,4,6,8,5,5,4,5,6,3,2,5,3,7,4],[5,7,8,6,1,8,4,2,4,9,7,7,7,6,7,4,3,5,8,3,2,4,3,8,4]])
print c3
n=n1+n2
m=(n1*m1+n2*m2)/n
print m
m4=m1-m
m5=m4.transpose()
m6=m2-m
m7=m6.transpose()
c21 = ((n1*c1) + (n2*c2) + n1*m5*m4 + n2*m7*m6)/ n
print c21



